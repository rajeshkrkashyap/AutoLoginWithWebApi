@page "/Index"
@using MockTestLab.Shared.Entities;
@inject IJSRuntime JS
@inject HttpClient httpClient

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app from Rzor Component Library.

<button @onclick="onbuttonclick"> Button  </button>


<SurveyPrompt Title="How is Blazor working for you?" />

@code {
    

    protected async override void OnAfterRender(bool firstRender)
    {
        base.OnAfterRender(firstRender);

        string authToken = await JS.InvokeAsync<string>("blazorApp.getCookieValue", "AuthToken");
        httpClient.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("Bearer", authToken);

        var response = await httpClient.GetAsync("http://localhost:53058/weatherforecast");
        var responseBody = await response.Content.ReadAsStringAsync();
        var weatherForcast = JsonConvert.DeserializeObject<IEnumerable<WeatherForecast>>(responseBody);
        
    }

    protected async void onbuttonclick(MouseEventArgs args)
    {
        await JS.InvokeVoidAsync("buttonClicked");
    }
}